(function () {

  function getParamFixed(name) {
    const qs = window.location.search || "";
    const raw = new URLSearchParams(qs).get(name);
    if (!raw) return null;

    // Origami/Links לפעמים שמים + במקום רווח
    return raw.replace(/\+/g, " ").trim();
  }

  function setCommunityHeader() {
    const community = getParamFixed("community");
    if (!community) return false;

    // נחפש כל אלמנט שמכיל "עבור" ונסדר אותו
    const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT, null);
    let node;

    while ((node = walker.nextNode())) {
      const t = (node.nodeValue || "").replace(/\u00A0/g, " ").trim(); // nbsp -> space
      if (t.startsWith("עבור")) {
        node.nodeValue = `עבור - ${community}`;
        return true;
      }
    }

    return false;
  }

  // ניסיון ראשון
  if (setCommunityHeader()) return;

  // נעקוב אחרי רינדורים/שינויים של אוריגמי
  const obs = new MutationObserver(() => {
    if (setCommunityHeader()) obs.disconnect();
  });

  obs.observe(document.documentElement, { childList: true, subtree: true, characterData: true });

})();
